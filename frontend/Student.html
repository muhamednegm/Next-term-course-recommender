<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Profile</title>
  <link rel="stylesheet" href="student.css">
  <link rel="icon" type="image/x.icon" href="logo.jpg">
  <script src="auth.js"></script>
</head>
<body>

<div class="app-container">
  <div class="menu-icon" onclick="toggleMenu()">â˜°</div>

  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <img src="logo.jpg" alt="College Logo" class="college-logo">
      <div class="close-btn" onclick="toggleMenu()">âœ•</div>
    </div>

    <ul>
      <li><a href="performance.html">ğŸ“ˆ Performance</a></li>
      <li><a href="student.html">ğŸ“ Student</a></li>
      <li><a href="recommended.html">â­ Recommended</a></li>
      <li><a href="settings.html">âš™ï¸ Settings</a></li>
      <li><a href="#" onclick="window.auth.logout()">ğŸšª Logout</a></li>
    </ul>
  </nav>

  <div class="container">
    <header class="header">
      <div class="header-left">
        <img src="img4.jpg" alt="Student" class="profile-pic">
        <h1>Student Profile</h1>
        <p id="profileDesc">view of student details <br> and academic performance</p>
      </div>
    </header>

    <section class="main-content">
      <div class="info-section">
        <div class="student-card">
          <img src="img4.jpg" class="student-img" alt="Student Photo">
          <h3 id="realName">Loading...</h3>
          <p class="id" id="realId">ID : Loading...</p>
          <h1 id="realGPA">0.0</h1>
          <p class="major" id="realMajor">Loading...</p>
          <p class="email" id="realEmail">Loading...</p>
        </div>

        <div class="gpa-card">
          <h3>GPA:</h3>
          <h4 id="realGPAValue">0.0</h4>
          <p id="realCredits">0/120</p>
          <div class="chart">
            <div class="bar bar1"></div>
            <div class="bar bar2"></div>
            <div class="bar bar3"></div>
            <div class="bar bar4"></div>
            <div class="bar bar5"></div>
          </div>
          <div class="labels">
            <span>sem1</span>
            <span>sem2</span>
            <span>sem3</span>
            <span>sem4</span>
            <span>sem5</span>
          </div>
        </div>
      </div>

      <div class="info-boxes">
        <div class="info blue">
          <span>âœ…</span>
          <p id="realCompleted">0/120</p>
        </div>
        <div class="info blue">
          <span>ğŸ“</span>
          <p id="realSemester">Loading...</p>
        </div>
        <div class="info blue">
          <span>ğŸ””</span>
          <p id="realAttendance">Loading...</p>
        </div>
      </div>
    </section>
  </div>

  <script>
    function toggleMenu() {
      document.getElementById("sidebar").classList.toggle("active");
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
    document.addEventListener('DOMContentLoaded', async function() {
      // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      const studentId = window.auth.checkLogin();
      if (!studentId) return;
      
      console.log('ğŸ”„ Loading student data for:', studentId);
      
      // 2. Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage (ØªÙ… Ø­ÙØ¸Ù‡Ø§ ÙÙŠ index.html)
      const studentName = localStorage.getItem('student_name') || 'Student';
      const studentMajor = localStorage.getItem('student_major') || 'Computer Science';
      const studentGPA = localStorage.getItem('student_gpa') || '3.5';
      const studentLevel = localStorage.getItem('selected_level') || '3';
      
      console.log('ğŸ“‹ Student data from localStorage:', {
        name: studentName,
        major: studentMajor,
        gpa: studentGPA,
        level: studentLevel
      });
      
      // 3. ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
      
      // Ø§Ù„Ø§Ø³Ù…
      document.querySelector('.student-card h3').textContent = studentName;
      
      // Ø§Ù„Ù€ ID
      document.querySelector('.student-card .id').textContent = `ID: ${studentId}`;
      
      // Ø§Ù„Ù€ GPA (ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„ÙƒØ¨ÙŠØ±)
      document.querySelector('.student-card h1').textContent = studentGPA;
      
      // Ø§Ù„ØªØ®ØµØµ
      document.querySelector('.student-card .major').textContent = studentMajor;
      
      // Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
      document.querySelector('.student-card .email').textContent = `${studentId.toLowerCase()}@university.edu`;
      
      // Ø§Ù„Ù€ GPA ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø¨ÙŠØ¶
      document.querySelector('.gpa-card h4').textContent = studentGPA;
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      const level = parseInt(studentLevel) || 3;
      const totalCredits = Math.min(level * 35, 120);
      document.querySelector('.gpa-card p').textContent = `${totalCredits}/120`;
      
      // Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
      const infoBoxes = document.querySelectorAll('.info p');
      if (infoBoxes.length >= 3) {
        // Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
        const completedCredits = Math.min(level * 30, 110);
        infoBoxes[0].textContent = `${completedCredits}/120`;
        
        // Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
        const year = 2025;
        const semester = level % 2 === 1 ? 'Fall' : 'Spring';
        infoBoxes[1].textContent = `${semester} ${year}`;
        
        // Ø§Ù„Ø­Ø¶ÙˆØ±
        const gpaValue = parseFloat(studentGPA) || 0;
        const attendanceRate = Math.min(85 + (gpaValue * 5), 98);
        infoBoxes[2].innerHTML = `Attendance:<br> ${attendanceRate.toFixed(1)}%`;
      }
      
      // ØªØ­Ø¯ÙŠØ« ÙˆØµÙ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
      document.querySelector('.header-left p').innerHTML = 
        `${studentName}'s details <br> and academic performance`;
      
      console.log('âœ… Student page updated with real data');
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      updateGPAChart(parseFloat(studentGPA) || 0);
    });

    // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function updateGPAChart(gpa) {
      const bars = document.querySelectorAll('.bar');
      if (!bars.length) return;
      
      const heights = [];
      for (let i = 0; i < 5; i++) {
        const semesterGPA = Math.min(gpa + (Math.random() * 0.5 - 0.25), 4.0);
        const height = 40 + (semesterGPA * 15);
        heights.push(height);
      }
      
      bars.forEach((bar, index) => {
        if (index < heights.length) {
          bar.style.height = `${heights[index]}%`;
          if (index === 2) {
            bar.style.backgroundColor = '#f39c12';
          } else {
            bar.style.backgroundColor = '#0b2d5c';
          }
        }
      });
    }
  </script>
</body>
</html>